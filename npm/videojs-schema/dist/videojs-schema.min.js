/*! @name videojs-schema @version 0.4.0 @license Apache-2.0 */
!function(e,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i(require("video.js"),require("global/document")):"function"==typeof define&&define.amd?define(["video.js","global/document"],i):e.videojsSchema=i(e.videojs,e.document)}(this,function(r,c){"use strict";r=r&&r.hasOwnProperty("default")?r.default:r,c=c&&c.hasOwnProperty("default")?c.default:c;var e={schemaId:"https://players.brightcove.net/{accountId}/{playerId}_{embedId}/index.html?videoId={id}",keywords:!1,excludeTags:[],baseObject:{},includeEmbedUrl:!0,preferLongDescription:!1},i=function(o){var a=this;this.schemaEl_=c.createElement("script"),this.schemaEl_.type="application/ld+json",c.head.appendChild(this.schemaEl_),o=r.mergeOptions(e,o),this.on(["loadstart","error"],function(e){if(a.bcinfo&&a.mediainfo&&a.mediainfo.id){var i=r.mergeOptions(o.baseObject,{"@context":"http://schema.org/","@type":"VideoObject",name:a.mediainfo.name,thumbnailUrl:a.mediainfo.poster,uploadDate:a.mediainfo.publishedAt.split("T")[0],"@id":o.schemaId.replace("{id}",a.mediainfo.id).replace("{referenceId}",a.mediainfo.referenceId).replace("{playerId}",a.bcinfo.playerId).replace("{embedId}",a.bcinfo.embedId).replace("{accountId}",a.bcinfo.accountId)});o.preferLongDescription?i.description=a.mediainfo.longDescription||a.mediainfo.description:i.description=a.mediainfo.description;var n=function(e){if(!((e=Math.round(e))<=0)&&isFinite(e)){var i=parseInt(e/3600,10),n=parseInt((e-3600*i)/60,10),t="PT";return 0<i&&(t+=i+"H"),0<n&&(t+=n+"M"),t+=e-3600*i-60*n+"S"}}(a.mediainfo.duration);if(n&&(i.duration=n),o.includeEmbedUrl)if(a.socialSettings){var t=c.createElement("div");t.innerHTML=a.socialOverlay.getEmbedCode(),i.embedUrl=t.querySelector("iframe").src}else i.embedUrl="https://players.brightcove.net/"+a.bcinfo.accountId+"/"+a.bcinfo.playerId+"_"+a.bcinfo.embedId+"/index.html?videoId="+a.mediainfo.id;if(o.keywords){var d=[];a.mediainfo.tags.forEach(function(e){-1===o.excludeTags.indexOf(e)&&d.push(e)}),0<d.length&&(i.keywords=d.join(","))}a.schemaEl_.textContent=JSON.stringify(i)}else r.log.warn("Unable to add schema without catalog info.")}),this.on("dispose",function(e){a.schemaEl_.parentNode.removeChild(a.schemaEl_)})};return r.registerPlugin("schema",i),i.VERSION="0.4.0",i});
